<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Unified Checkout - Widget Payment</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #0070f3;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
        }
        .test-button:hover {
            background: #0051a2;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .comparison {
            display: flex;
            gap: 20px;
        }
        .comparison > div {
            flex: 1;
        }
        .widget-demo {
            background: #e8f4fd;
        }
        .product-demo {
            background: #f0f8ff;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ðŸŽ‰ Unified Checkout Test</h1>
        <p>This page tests that both widget payments and product payments now use the same professional checkout interface.</p>
        
        <div class="comparison">
            <div class="widget-demo test-section">
                <h3>Widget Payment (SDK)</h3>
                <p>Previously used simple WidgetPay.jsx</p>
                <p><strong>Now uses:</strong> Professional SuiFlowCheckout.jsx</p>
                <button class="test-button" onclick="testWidgetPayment()">
                    Test Widget Payment
                </button>
                <p><small>Opens: /widget/pay?merchantId=test&amount=1.5</small></p>
            </div>
            
            <div class="product-demo test-section">
                <h3>Product Payment (Links)</h3>
                <p>Already used professional SuiFlowCheckout.jsx</p>
                <p><strong>Still uses:</strong> Professional SuiFlowCheckout.jsx</p>
                <button class="test-button" onclick="testProductPayment()">
                    Test Product Payment
                </button>
                <p><small>Opens: /checkout/test-product-id</small></p>
            </div>
        </div>
        
        <div class="test-section">
            <h3>Test Results</h3>
            <p>âœ… Both payment flows should now have:</p>
            <ul>
                <li>Professional step-by-step checkout UI</li>
                <li>SuiFlow branding and styling</li>
                <li>FlowX widget integration</li>
                <li>Currency conversion (NGN â†” SUI)</li>
                <li>Email collection</li>
                <li>Secure payment badges</li>
            </ul>
        </div>
        
        <div class="test-section">
            <h3>Technical Implementation</h3>
            <p><strong>Changes Made:</strong></p>
            <ul>
                <li>âœ… Updated router.jsx: /widget/pay â†’ SuiFlowCheckout</li>
                <li>âœ… Modified SuiFlowCheckout.jsx to detect widget vs product payments</li>
                <li>âœ… Added dual API support: /api/widget-payments/ & /api/payments/</li>
                <li>âœ… Unified payment processing logic</li>
                <li>âœ… Fixed widgetAmount â†’ initialAmount references</li>
            </ul>
        </div>
    </div>

    <script>
        function testWidgetPayment() {
            // Simulate widget payment like SDK would do
            const widgetUrl = 'http://localhost:5173/widget/pay?merchantId=merchant123&amount=1.5';
            window.open(widgetUrl, 'suiflow-widget', 'width=500,height=700,scrollbars=yes');
        }
        
        function testProductPayment() {
            // Test regular product payment
            const productUrl = 'http://localhost:5173/pay/687cedb6e6a95e684151549b';
            window.open(productUrl, 'suiflow-product', 'width=500,height=700,scrollbars=yes');
        }
        
        // Listen for success messages from widget
        window.addEventListener('message', (event) => {
            if (event.data.suiflowSuccess) {
                alert('Widget Payment Successful! TX: ' + event.data.txHash);
                console.log('Payment completed:', event.data);
            }
        });
    </script>
</body>
</html>
